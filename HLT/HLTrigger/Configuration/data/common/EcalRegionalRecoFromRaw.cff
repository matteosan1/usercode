//
// Regional Ecal reco based on Level-1 seeds for Egamma, Muons and Taus
//


//
// Getting the list of Ecal FEDs
//   uses EcalListOfFedsProducer module in RecoEgamma/EgammaHLTProducers
//
include "RecoEgamma/EgammaHLTProducers/data/ecalRegionalEgammaFEDs.cfi"
include "RecoEgamma/EgammaHLTProducers/data/ecalRegionalMuonsFEDs.cfi"
include "RecoEgamma/EgammaHLTProducers/data/ecalRegionalTausFEDs.cfi"
include "RecoEgamma/EgammaHLTProducers/data/ecalRegionalJetsFEDs.cfi"
include "RecoEgamma/EgammaHLTProducers/data/ecalRegionalRestFEDs.cfi"


//
// Unpacking Digis based on FED lists
//   uses EcalRawToDigiDev module in EventFilter/EcalRawToDigiDev
//
module  ecalRegionalEgammaDigis = ecalEBunpacker from "EventFilter/EcalRawToDigiDev/data/EcalUnpackerData.cfi"
replace ecalRegionalEgammaDigis.InputLabel="rawDataCollector"
replace ecalRegionalEgammaDigis.DoRegional = true
replace ecalRegionalEgammaDigis.FedLabel = "ecalRegionalEgammaFEDs"

module  ecalRegionalMuonsDigis = ecalEBunpacker from "EventFilter/EcalRawToDigiDev/data/EcalUnpackerData.cfi"
replace ecalRegionalMuonsDigis.InputLabel="rawDataCollector"
replace ecalRegionalMuonsDigis.DoRegional = true
replace ecalRegionalMuonsDigis.FedLabel = "ecalRegionalMuonsFEDs"

module  ecalRegionalTausDigis = ecalEBunpacker from "EventFilter/EcalRawToDigiDev/data/EcalUnpackerData.cfi"
replace ecalRegionalTausDigis.InputLabel="rawDataCollector"
replace ecalRegionalTausDigis.DoRegional = true
replace ecalRegionalTausDigis.FedLabel = "ecalRegionalTausFEDs"

module ecalRegionalJetsDigis = ecalEBunpacker from "EventFilter/EcalRawToDigiDev/data/EcalUnpackerData.cfi"
replace ecalRegionalJetsDigis.InputLabel="rawDataCollector"
replace ecalRegionalJetsDigis.DoRegional = true
replace ecalRegionalJetsDigis.FedLabel = "ecalRegionalJetsFEDs"

module ecalRegionalRestDigis = ecalEBunpacker from "EventFilter/EcalRawToDigiDev/data/EcalUnpackerData.cfi"
replace ecalRegionalRestDigis.InputLabel="rawDataCollector"
replace ecalRegionalRestDigis.DoRegional = true
replace ecalRegionalRestDigis.FedLabel = "ecalRegionalRestFEDs"


//
// From here on simply cloning ecalLocalRecoSequence.cff
//   with updated InputTags
//
# Calo geometry service model
include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"

module  ecalRegionalEgammaWeightUncalibRecHit = ecalWeightUncalibRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalWeightUncalibRecHit.cfi"
replace ecalRegionalEgammaWeightUncalibRecHit.EBdigiCollection = ecalRegionalEgammaDigis:ebDigis
replace ecalRegionalEgammaWeightUncalibRecHit.EEdigiCollection = ecalRegionalEgammaDigis:eeDigis
module  ecalRegionalEgammaRecHitTmp = ecalRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalRecHit.cfi"
replace ecalRegionalEgammaRecHitTmp.EBuncalibRecHitCollection = ecalRegionalEgammaWeightUncalibRecHit:EcalUncalibRecHitsEB
replace ecalRegionalEgammaRecHitTmp.EEuncalibRecHitCollection = ecalRegionalEgammaWeightUncalibRecHit:EcalUncalibRecHitsEE
module ecalRegionalEgammaRecHit = ecalRecHitMerger from "RecoEgamma/EgammaHLTProducers/data/ecalRecHitMerger.cfi"


module  ecalRegionalMuonsWeightUncalibRecHit = ecalWeightUncalibRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalWeightUncalibRecHit.cfi"
replace ecalRegionalMuonsWeightUncalibRecHit.EBdigiCollection = ecalRegionalMuonsDigis:ebDigis
replace ecalRegionalMuonsWeightUncalibRecHit.EEdigiCollection = ecalRegionalMuonsDigis:eeDigis
module  ecalRegionalMuonsRecHitTmp = ecalRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalRecHit.cfi"
replace ecalRegionalMuonsRecHitTmp.EBuncalibRecHitCollection = ecalRegionalMuonsWeightUncalibRecHit:EcalUncalibRecHitsEB
replace ecalRegionalMuonsRecHitTmp.EEuncalibRecHitCollection = ecalRegionalMuonsWeightUncalibRecHit:EcalUncalibRecHitsEE
module ecalRegionalMuonsRecHit = ecalRecHitMerger from "RecoEgamma/EgammaHLTProducers/data/ecalRecHitMerger.cfi"


module  ecalRegionalTausWeightUncalibRecHit = ecalWeightUncalibRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalWeightUncalibRecHit.cfi"
replace ecalRegionalTausWeightUncalibRecHit.EBdigiCollection = ecalRegionalTausDigis:ebDigis
replace ecalRegionalTausWeightUncalibRecHit.EEdigiCollection = ecalRegionalTausDigis:eeDigis
module  ecalRegionalTausRecHitTmp = ecalRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalRecHit.cfi"
replace ecalRegionalTausRecHitTmp.EBuncalibRecHitCollection = ecalRegionalTausWeightUncalibRecHit:EcalUncalibRecHitsEB
replace ecalRegionalTausRecHitTmp.EEuncalibRecHitCollection = ecalRegionalTausWeightUncalibRecHit:EcalUncalibRecHitsEE
module ecalRegionalTausRecHit = ecalRecHitMerger from "RecoEgamma/EgammaHLTProducers/data/ecalRecHitMerger.cfi"

module ecalRegionalJetsWeightUncalibRecHit = ecalWeightUncalibRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalWeightUncalibRecHit.cfi"
replace ecalRegionalJetsWeightUncalibRecHit.EBdigiCollection = ecalRegionalJetsDigis:ebDigis
replace ecalRegionalJetsWeightUncalibRecHit.EEdigiCollection = ecalRegionalJetsDigis:eeDigis
module  ecalRegionalJetsRecHitTmp = ecalRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalRecHit.cfi"
replace ecalRegionalJetsRecHitTmp.EBuncalibRecHitCollection = ecalRegionalJetsWeightUncalibRecHit:EcalUncalibRecHitsEB
replace ecalRegionalJetsRecHitTmp.EEuncalibRecHitCollection = ecalRegionalJetsWeightUncalibRecHit:EcalUncalibRecHitsEE
module  ecalRegionalJetsRecHit = ecalRecHitMerger from "RecoEgamma/EgammaHLTProducers/data/ecalRecHitMerger.cfi"

module ecalRegionalRestWeightUncalibRecHit = ecalWeightUncalibRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalWeightUncalibRecHit.cfi"
replace ecalRegionalRestWeightUncalibRecHit.EBdigiCollection = ecalRegionalRestDigis:ebDigis
replace ecalRegionalRestWeightUncalibRecHit.EEdigiCollection = ecalRegionalRestDigis:eeDigis
module ecalRegionalRestRecHitTmp = ecalRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalRecHit.cfi"
replace ecalRegionalRestRecHitTmp.EBuncalibRecHitCollection = ecalRegionalRestWeightUncalibRecHit:EcalUncalibRecHitsEB
replace ecalRegionalRestRecHitTmp.EEuncalibRecHitCollection = ecalRegionalRestWeightUncalibRecHit:EcalUncalibRecHitsEE
module ecalRecHitAll = ecalRecHitMerger from "RecoEgamma/EgammaHLTProducers/data/ecalRecHitMerger.cfi"


//
// Preshower is unchanged!
//
include "RecoLocalCalo/EcalRecProducers/data/ecalPreshowerRecHit.cfi"

//
// sequence definition
//
sequence ecalRegionalEgammaRecoSequence = { 
  ecalRegionalEgammaFEDs , ecalRegionalEgammaDigis ,  
  ecalRegionalEgammaWeightUncalibRecHit , ecalRegionalEgammaRecHitTmp, ecalRegionalEgammaRecHit &
  ecalPreshowerRecHit }

sequence ecalRegionalMuonsRecoSequence = { 
  ecalRegionalMuonsFEDs , ecalRegionalMuonsDigis ,
  ecalRegionalMuonsWeightUncalibRecHit , ecalRegionalMuonsRecHitTmp, ecalRegionalMuonsRecHit &
  ecalPreshowerRecHit }

sequence ecalRegionalTausRecoSequence = {
  ecalRegionalTausFEDs , ecalRegionalTausDigis ,
  ecalRegionalTausWeightUncalibRecHit , ecalRegionalTausRecHitTmp, ecalRegionalTausRecHit &
  ecalPreshowerRecHit }

sequence ecalRegionalJetsRecoSequence = {
  ecalRegionalJetsFEDs , ecalRegionalJetsDigis ,
  ecalRegionalJetsWeightUncalibRecHit , ecalRegionalJetsRecHitTmp , ecalRegionalJetsRecHit &
  ecalPreshowerRecHit }

sequence ecalAllRecoSequence = {
  ecalRegionalRestFEDs , ecalRegionalRestDigis ,
  ecalRegionalRestWeightUncalibRecHit , ecalRegionalRestRecHitTmp , ecalRecHitAll &
  ecalPreshowerRecHit }


