process ConvertedPhoton = 
{


service = MessageLogger 
  {
  untracked vstring destinations   = { "/tmp/nancy/debugmessages.txt" }
  untracked vstring categories     = { "ConvertedPhotonAnalyzer", "ConvertedPhotonProducer", "ConversionTrackCandidateProducer", "ConversionSeesFinder", "ConversionTrackPairFinder", "ConversionVertexFinder",  "InOutConversionSeedFinder", "InOutConversionTrackFinder", "OutInConversionSeedFinder", "OutInConversionTrackFinder"}
  untracked vstring debugModules   = { "*" }
  untracked PSet debugmessages.txt = { untracked string threshold = "DEBUG"
                                       untracked PSet INFO            = { untracked int32 limit = 0 }
                                       untracked PSet DEBUG           = { untracked int32 limit = 0 }
			               untracked PSet ConvertedPhotonAnalyzer = { untracked int32 limit = 10000000}
                                       untracked PSet ConvertedPhotonProducer = { untracked int32 limit = 10000000}	
                                       untracked PSet ConversionTrackCandidateProducer = { untracked int32 limit = 10000000}
		                       untracked PSet ConversionSeedFinder = { untracked int32 limit = 10000000}
                                       untracked PSet ConversionTrackPairFinder = { untracked int32 limit = 10000000}
                                       untracked PSet ConversionVertexFinder = { untracked int32 limit = 10000000}
                                       untracked PSet OutInConversionSeedFinder = { untracked int32 limit = 10000000}
                                       untracked PSet OutInConversionTrackFinder = { untracked int32 limit = 10000000}
                                       untracked PSet InOutConversionSeedFinder = { untracked int32 limit = 10000000}
                                       untracked PSet InOutConversionTrackFinder = { untracked int32 limit = 10000000}

  }
} 


 source = PoolSource 
  {
     untracked vstring fileNames = {'file:allRecoDiPhotonPt35WithConversions3K.root'}
   
  }

  # Number of events program should run
  untracked PSet maxEvents = {untracked int32 input = -1}

# initialize magnetic field
include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

include "Geometry/CMSCommonData/data/cmsMagneticFieldXML.cfi"

# for the geometry:
# full detector geometry
include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"

#--------------------------------
# Ecalgeometry for clustering
#--------------------------------
#include "RecoEcal/EgammaClusterProducers/data/geometryForClustering.cff"
#include "Geometry/CaloEventSetup/test/data/testCaloConfiguration.cfi"

include "Geometry/CaloEventSetup/data/CaloGeometry.cff"

### Ecal clustering
# create sequence for island clustering
include "RecoEcal/EgammaClusterProducers/data/islandClusteringSequence.cff"

# hybrid clustering sequence
include "RecoEcal/EgammaClusterProducers/data/hybridClusteringSequence.cff"

# clusters in preshower
include "RecoEcal/EgammaClusterProducers/data/preshowerClusteringSequence.cff"

# create path with all clustering algos
# NB: preshower MUST be run after island clustering in the endcap
sequence ecalClusteringSequence = {
                                    islandClusteringSequence,
                                    hybridClusteringSequence,
                                    preshowerClusteringSequence
                                  }


# sequence trackerRecHit = { siPixelClusters,siPixelRecHits,siStripClusters,siStripRecHits}
 sequence trackerRecHit  = { siStripClusters, siStripMatchedRecHits }


# photon sequence
include "RecoEgamma/EgammaPhotonProducers/data/convertedPhotonSequence.cff"

# Tracking Truth
#  include "SimGeneral/TrackingAnalysis/data/trackingtruth.cfi"


# analyzer to make histos from super clusters
 include "RecoEgamma/EgammaPhotonProducers/data/convertedPhotonAnalyzer.cfi"


# path p1 = { ecalClusteringSequence, convertedPhotonSequence,  trackingtruth, convertedPhotonAnalyzer   }
path p1 = { ecalClusteringSequence, convertedPhotonSequence }



  module o1 = PoolOutputModule
   { 
      #untracked string fileName = "/tmp/nancy/RecoConversionsFromBtoBWithoutConversions.root"
      #untracked string fileName = "/tmp/nancy/RecoConversionsFromDiPhotonPt35_1.root"
      untracked string fileName = "reRecoDiPhotonPt35WithConversions3K.root"
      untracked vstring outputCommands =
      {
         "drop *", 
         "keep *_g4SimHits_*_*",
         "keep edmHepMCProduct_*_*_*",
         "keep recoSuperClusters_*_*_*",
         "keep recoConvertedPhotons_*_*_*",
         "keep recoPhotons_*_*_*",
         "keep *_conversionTrackCandidates_*_*",
         "keep recoTracks_ckfOutInTracksFromConversionsBarrel_*_*",
         "keep recoTracks_ckfInOutTracksFromConversionsBarrel_*_*",
         "keep recoTracks_ckfOutInTracksFromConversionsEndcap_*_*",
         "keep recoTracks_ckfInOutTracksFromConversionsEndcap_*_*",
         "keep recoTrackExtras_ckfOutInTracksFromConversionsBarrel_*_*",
         "keep recoTrackExtras_ckfInOutTracksFromConversionsBarrel_*_*",
         "keep recoTrackExtras_ckfOutInTracksFromConversionsEndcap_*_*",
         "keep recoTrackExtras_ckfInOutTracksFromConversionsEndcap_*_*"
      }
   }


   endpath outpath = { o1 }




}


